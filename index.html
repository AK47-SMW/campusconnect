<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Calculator</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet"/>
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #0a0a1a;
      font-family: 'Inter', sans-serif;
      overflow: hidden;
    }

    /* Animated background orbs */
    .bg-orb {
      position: fixed;
      border-radius: 50%;
      filter: blur(80px);
      opacity: 0.35;
      animation: floatOrb 10s ease-in-out infinite;
      pointer-events: none;
    }
    .bg-orb.o1 { width: 400px; height: 400px; background: #7c3aed; top: -100px; left: -100px; animation-delay: 0s; }
    .bg-orb.o2 { width: 350px; height: 350px; background: #2563eb; bottom: -80px; right: -80px; animation-delay: -4s; }
    .bg-orb.o3 { width: 250px; height: 250px; background: #db2777; top: 50%; left: 50%; transform: translate(-50%,-50%); animation-delay: -7s; }

    @keyframes floatOrb {
      0%, 100% { transform: translate(0, 0) scale(1); }
      33%       { transform: translate(30px, -20px) scale(1.05); }
      66%       { transform: translate(-20px, 30px) scale(0.95); }
    }

    /* Calculator shell */
    .calc-wrapper {
      position: relative;
      z-index: 10;
      animation: slideUp 0.6s cubic-bezier(.22,1,.36,1) both;
    }
    @keyframes slideUp {
      from { opacity: 0; transform: translateY(60px) scale(0.95); }
      to   { opacity: 1; transform: translateY(0) scale(1); }
    }

    .calculator {
      width: 340px;
      background: rgba(255,255,255,0.07);
      backdrop-filter: blur(24px);
      -webkit-backdrop-filter: blur(24px);
      border: 1px solid rgba(255,255,255,0.12);
      border-radius: 28px;
      padding: 24px;
      box-shadow:
        0 8px 40px rgba(0,0,0,0.5),
        0 0 0 1px rgba(255,255,255,0.06) inset,
        0 1px 0 rgba(255,255,255,0.15) inset;
    }

    /* Display */
    .display {
      background: rgba(0,0,0,0.3);
      border-radius: 18px;
      padding: 20px 20px 14px;
      margin-bottom: 20px;
      border: 1px solid rgba(255,255,255,0.07);
      min-height: 110px;
      display: flex;
      flex-direction: column;
      justify-content: flex-end;
      overflow: hidden;
    }
    .expr {
      color: rgba(255,255,255,0.4);
      font-size: 14px;
      font-weight: 300;
      text-align: right;
      min-height: 20px;
      transition: all 0.2s ease;
      word-break: break-all;
      letter-spacing: 0.5px;
    }
    .result {
      color: #fff;
      font-size: 44px;
      font-weight: 300;
      text-align: right;
      letter-spacing: -1px;
      transition: all 0.25s cubic-bezier(.22,1,.36,1);
      word-break: break-all;
      line-height: 1.1;
    }
    .result.pop {
      animation: pop 0.25s cubic-bezier(.22,1,.36,1);
    }
    @keyframes pop {
      0%   { transform: scale(0.88); opacity: 0.5; }
      60%  { transform: scale(1.04); }
      100% { transform: scale(1);    opacity: 1; }
    }
    .result.shake {
      animation: shake 0.35s ease;
    }
    @keyframes shake {
      0%,100% { transform: translateX(0); }
      20%     { transform: translateX(-8px); }
      40%     { transform: translateX(8px); }
      60%     { transform: translateX(-5px); }
      80%     { transform: translateX(5px); }
    }

    /* Button grid */
    .buttons {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 10px;
    }

    /* Base button */
    .btn {
      position: relative;
      overflow: hidden;
      border: none;
      border-radius: 16px;
      height: 68px;
      font-family: 'Inter', sans-serif;
      font-size: 18px;
      font-weight: 500;
      cursor: pointer;
      transition:
        transform 0.12s cubic-bezier(.22,1,.36,1),
        box-shadow 0.15s ease,
        background 0.2s ease;
      -webkit-tap-highlight-color: transparent;
      outline: none;
      user-select: none;
    }

    /* Ripple */
    .ripple {
      position: absolute;
      border-radius: 50%;
      transform: scale(0);
      animation: rippleAnim 0.55s linear;
      pointer-events: none;
      background: rgba(255,255,255,0.25);
    }
    @keyframes rippleAnim {
      to { transform: scale(4); opacity: 0; }
    }

    .btn:active { transform: scale(0.91); }

    /* Number / default buttons */
    .btn.num {
      background: rgba(255,255,255,0.09);
      color: #fff;
      border: 1px solid rgba(255,255,255,0.1);
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    }
    .btn.num:hover {
      background: rgba(255,255,255,0.16);
      box-shadow: 0 6px 20px rgba(0,0,0,0.3);
      transform: translateY(-2px);
    }

    /* Operator buttons */
    .btn.op {
      background: linear-gradient(135deg, rgba(124,58,237,0.6), rgba(99,40,220,0.5));
      color: #c4b5fd;
      border: 1px solid rgba(167,139,250,0.25);
      box-shadow: 0 4px 16px rgba(124,58,237,0.3);
    }
    .btn.op:hover {
      background: linear-gradient(135deg, rgba(139,92,246,0.75), rgba(124,58,237,0.65));
      box-shadow: 0 6px 24px rgba(124,58,237,0.45);
      transform: translateY(-2px);
    }

    /* Action / top row */
    .btn.action {
      background: rgba(255,255,255,0.06);
      color: rgba(255,255,255,0.7);
      border: 1px solid rgba(255,255,255,0.08);
      font-size: 15px;
      font-weight: 400;
    }
    .btn.action:hover {
      background: rgba(255,255,255,0.12);
      transform: translateY(-2px);
    }

    /* Equals button */
    .btn.eq {
      background: linear-gradient(135deg, #7c3aed, #2563eb);
      color: #fff;
      border: none;
      box-shadow: 0 6px 24px rgba(124,58,237,0.5);
      font-size: 22px;
    }
    .btn.eq:hover {
      background: linear-gradient(135deg, #8b5cf6, #3b82f6);
      box-shadow: 0 8px 30px rgba(124,58,237,0.65);
      transform: translateY(-2px);
    }

    /* Zero wide */
    .btn.zero { grid-column: span 2; }

    /* Dot */
    .btn.dot { font-size: 24px; font-weight: 600; line-height: 1; }
  </style>
</head>
<body>

  <!-- Background orbs -->
  <div class="bg-orb o1"></div>
  <div class="bg-orb o2"></div>
  <div class="bg-orb o3"></div>

  <div class="calc-wrapper">
    <div class="calculator">
      <div class="display">
        <div class="expr" id="expr"></div>
        <div class="result" id="result">0</div>
      </div>
      <div class="buttons">
        <!-- Row 1 -->
        <button class="btn action" data-action="clear">AC</button>
        <button class="btn action" data-action="sign">+/−</button>
        <button class="btn action" data-action="percent">%</button>
        <button class="btn op"     data-action="op" data-val="÷">÷</button>
        <!-- Row 2 -->
        <button class="btn num" data-action="digit" data-val="7">7</button>
        <button class="btn num" data-action="digit" data-val="8">8</button>
        <button class="btn num" data-action="digit" data-val="9">9</button>
        <button class="btn op"  data-action="op"    data-val="×">×</button>
        <!-- Row 3 -->
        <button class="btn num" data-action="digit" data-val="4">4</button>
        <button class="btn num" data-action="digit" data-val="5">5</button>
        <button class="btn num" data-action="digit" data-val="6">6</button>
        <button class="btn op"  data-action="op"    data-val="−">−</button>
        <!-- Row 4 -->
        <button class="btn num" data-action="digit" data-val="1">1</button>
        <button class="btn num" data-action="digit" data-val="2">2</button>
        <button class="btn num" data-action="digit" data-val="3">3</button>
        <button class="btn op"  data-action="op"    data-val="+">+</button>
        <!-- Row 5 -->
        <button class="btn num zero" data-action="digit" data-val="0">0</button>
        <button class="btn num dot"  data-action="dot">.</button>
        <button class="btn eq"       data-action="equals">=</button>
      </div>
    </div>
  </div>

  <script>
    const resultEl = document.getElementById('result');
    const exprEl   = document.getElementById('expr');

    let current   = '0';
    let previous  = '';
    let operator  = null;
    let justEvaled = false;
    let hasDecimal = false;

    function updateDisplay(val, animate = false) {
      let display = val;
      if (display.length > 12) {
        const n = parseFloat(val);
        if (!isNaN(n)) display = n.toPrecision(8).replace(/\.?0+$/, '');
      }
      resultEl.textContent = display;
      if (animate) {
        resultEl.classList.remove('pop');
        void resultEl.offsetWidth;
        resultEl.classList.add('pop');
      }
    }

    function triggerShake() {
      resultEl.classList.remove('shake');
      void resultEl.offsetWidth;
      resultEl.classList.add('shake');
    }

    function getOp(sym) {
      if (sym === '÷') return (a,b) => b === 0 ? null : a / b;
      if (sym === '×') return (a,b) => a * b;
      if (sym === '−') return (a,b) => a - b;
      if (sym === '+') return (a,b) => a + b;
    }

    function doCalc() {
      if (!operator || previous === '') return parseFloat(current);
      const a = parseFloat(previous);
      const b = parseFloat(current);
      const fn = getOp(operator);
      const r  = fn(a, b);
      return r;
    }

    function handleDigit(v) {
      if (justEvaled) { current = v; justEvaled = false; previous = ''; operator = null; }
      else if (current === '0' && v !== '.') current = v;
      else current += v;
      updateDisplay(current);
    }

    function handleDot() {
      if (justEvaled) { current = '0.'; justEvaled = false; }
      else if (!current.includes('.')) current += '.';
      updateDisplay(current);
    }

    function handleOp(sym) {
      if (operator && !justEvaled) {
        const r = doCalc();
        if (r === null) { exprEl.textContent = 'Cannot ÷ by 0'; triggerShake(); return; }
        previous = String(parseFloat(r.toFixed(10)));
        updateDisplay(previous, true);
      } else {
        previous = current;
      }
      operator  = sym;
      justEvaled = false;
      current   = '0';
      exprEl.textContent = `${previous} ${sym}`;
    }

    function handleEquals() {
      if (!operator) return;
      const r = doCalc();
      exprEl.textContent = `${previous} ${operator} ${current} =`;
      if (r === null) { resultEl.textContent = 'Error'; triggerShake(); return; }
      const res = parseFloat(r.toFixed(10));
      current   = String(res);
      previous  = '';
      operator  = null;
      justEvaled = true;
      updateDisplay(current, true);
    }

    function handleClear() {
      current = '0'; previous = ''; operator = null; justEvaled = false;
      exprEl.textContent = '';
      updateDisplay('0', true);
    }

    function handleSign() {
      current = String(parseFloat(current) * -1);
      updateDisplay(current);
    }

    function handlePercent() {
      current = String(parseFloat(current) / 100);
      updateDisplay(current);
    }

    // Button click handler + ripple
    document.querySelectorAll('.btn').forEach(btn => {
      btn.addEventListener('click', e => {
        // Ripple
        const rect = btn.getBoundingClientRect();
        const size = Math.max(rect.width, rect.height);
        const ripple = document.createElement('span');
        ripple.className = 'ripple';
        ripple.style.cssText = `width:${size}px;height:${size}px;left:${e.clientX - rect.left - size/2}px;top:${e.clientY - rect.top - size/2}px`;
        btn.appendChild(ripple);
        ripple.addEventListener('animationend', () => ripple.remove());

        // Logic
        const { action, val } = btn.dataset;
        if (action === 'digit')   handleDigit(val);
        else if (action === 'dot')    handleDot();
        else if (action === 'op')     handleOp(val);
        else if (action === 'equals') handleEquals();
        else if (action === 'clear')  handleClear();
        else if (action === 'sign')   handleSign();
        else if (action === 'percent')handlePercent();
      });
    });

    // Keyboard support
    document.addEventListener('keydown', e => {
      if (e.key >= '0' && e.key <= '9') handleDigit(e.key);
      else if (e.key === '.')  handleDot();
      else if (e.key === '+')  handleOp('+');
      else if (e.key === '-')  handleOp('−');
      else if (e.key === '*')  handleOp('×');
      else if (e.key === '/')  { e.preventDefault(); handleOp('÷'); }
      else if (e.key === 'Enter' || e.key === '=') handleEquals();
      else if (e.key === 'Escape' || e.key === 'c') handleClear();
      else if (e.key === 'Backspace') {
        if (current.length > 1) current = current.slice(0,-1);
        else current = '0';
        updateDisplay(current);
      }
    });
  </script>
</body>
</html>
